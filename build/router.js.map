{"version":3,"file":"router.js","sourceRoot":"","sources":["../src/router.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,OAAO,CAAC;AAC1B,OAAO,KAAK,YAAY,MAAM,SAAS,CAAC;AACxC,OAAO,EAAE,SAAS,EAAE,MAAM,yBAAyB,CAAC;AAsBpD,MAAM,UAAU,cAAc,CAC5B,MAA2B;IAE3B,OAAO,CAAC,CAAC,MAAM,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AACvD,CAAC;AAED,SAAS,MAAM,CAAC,IAAS;IACvB,OAAO,CACL,OAAO,IAAI,KAAK,QAAQ;QACxB,CAAC,OAAO,IAAI,KAAK,QAAQ;YACvB,IAAI,KAAK,IAAI;YACb,OAAO,IAAI,CAAC,QAAQ,KAAK,QAAQ,CAAC,CACrC,CAAC;AACJ,CAAC;AAID;;;;;;GAMG;AACH,MAAM,UAAU,qBAAqB,CACnC,QAEgD;IAEhD,MAAM,MAAM,GAAG,SAAS,EAAE,CAAC;IAE3B,KAAK,CAAC,SAAS,CAAC,GAAG,EAAE;QACnB,IAAI,SAAS,GAAG,IAAI,CAAC;QAErB,MAAM,aAAa,GAAG,CAAC,IAAyB,EAAE,EAAE;YAClD,IAAI,SAAS,EAAE,CAAC;gBACd,IAAI,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,IAAI,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC;oBAC9C,UAAU,CAAC,GAAG,EAAE;wBACd,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;oBACpC,CAAC,CAAC,CAAC;gBACL,CAAC;YACH,CAAC;QACH,CAAC,CAAC;QAEF,IAAI,YAAY,CAAC,OAAO,EAAE,CAAC;YACzB,aAAa,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;QACtC,CAAC;QAED,MAAM,GAAG,GAAG,YAAY,CAAC,WAAW,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;QACtE,OAAO,GAAG,EAAE;YACV,SAAS,GAAG,KAAK,CAAC;YAClB,GAAG,EAAE,MAAM,EAAE,CAAC;QAChB,CAAC,CAAC;IACJ,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;AAC/C,CAAC","sourcesContent":["import React from \"react\";\r\nimport * as QuickActions from \"./index\";\r\nimport { useRouter } from \"expo-router/build/hooks\";\r\n\r\ntype Href = any;\r\n\r\n// type TypedHref = Parameters<typeof router.push>[0];\r\n\r\nexport type RouterAction<THref extends Href = Href> = Omit<\r\n  QuickActions.Action,\r\n  \"params\"\r\n> & {\r\n  id: string;\r\n  title: string;\r\n  icon?: string | null;\r\n  /** iOS-only. Subtitle for the action. */\r\n  subtitle?: string | null;\r\n  /** Additional serial parameters for the action. */\r\n  params: {\r\n    /** Href should be defined in router projects. */\r\n    href: THref;\r\n  } & QuickActions.Action[\"params\"];\r\n};\r\n\r\nexport function isRouterAction(\r\n  action: QuickActions.Action\r\n): action is RouterAction {\r\n  return !!action.params && isHref(action.params.href);\r\n}\r\n\r\nfunction isHref(href: any): href is Href {\r\n  return (\r\n    typeof href === \"string\" ||\r\n    (typeof href === \"object\" &&\r\n      href !== null &&\r\n      typeof href.pathname === \"string\")\r\n  );\r\n}\r\n\r\ntype OptionalPromise<T> = T | Promise<T>;\r\n\r\n/**\r\n * Handle quick actions with `params.href`.\r\n *\r\n * **Warning:** This should be used inside of a sub-layout route (`app/(root)/_layout.tsx`) and not inside the root layout route (`app/_layout.tsx`) as it will attempt a navigation.\r\n *\r\n * @param callback optional callback to handle the action. If the callback returns true, the router will **not** handle the action.\r\n */\r\nexport function useQuickActionRouting(\r\n  callback?: (\r\n    data: QuickActions.Action\r\n  ) => OptionalPromise<boolean | undefined | void>\r\n) {\r\n  const router = useRouter();\r\n\r\n  React.useEffect(() => {\r\n    let isMounted = true;\r\n\r\n    const validCallback = (data: QuickActions.Action) => {\r\n      if (isMounted) {\r\n        if (!callback?.(data) && isRouterAction(data)) {\r\n          setTimeout(() => {\r\n            router.navigate(data.params.href);\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    if (QuickActions.initial) {\r\n      validCallback(QuickActions.initial);\r\n    }\r\n\r\n    const sub = QuickActions.addListener((event) => validCallback(event));\r\n    return () => {\r\n      isMounted = false;\r\n      sub?.remove();\r\n    };\r\n  }, [QuickActions.initial, router, callback]);\r\n}\r\n"]}